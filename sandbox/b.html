<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Document</title>
  </head>
  <body>
    <script src="/axios.js"></script>
    <script>
      function pTime(time = 1000) {
        return new Promise((resolve, reject) => {
          setTimeout(resolve, time)
        })
      }

      function initAxios() {
        const ax = axios.create({
          baseURL: '/api',
        })
        // 请求拦截
        ax.interceptors.request.use((config) => {
          // console.log('request_config1', config)
          return config
        })

        // 响应拦截
        ax.interceptors.response.use(
          (res) => {
            // console.log('response', res)
            return res.data
          },
          (err) => {
            // console.log('response_error', err)
            return Promise.reject(err)
          }
        )
        return ax
      }
      const CancelToken = axios.CancelToken
      const source = CancelToken.source()
      const myax = initAxios()
      myax.post(
        '/ccc',
        {
          userId: 1,
          pid: 2,
        },
        {
          cancelToken: source.token,
        }
      )

      const myax = initAxios()
      myax('/ccc', {
        userId: 1,
        pid: 2,
      })
        .then((res) => {
          console.log('then', res)
        })
        .catch((err) => {
          console.error('catch_err_', err)
        })
      // source.cancel('成功取消了请求')
      console.log('catch_err_', err)
    </script>
  </body>
</html>
